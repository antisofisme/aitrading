{
  "connection": {
    "bootstrap_servers": ["suho-kafka:9092"],
    "external_bootstrap_servers": ["suho-kafka:9092"],
    "client_id": "suho-trading-client",
    "security_protocol": "PLAINTEXT",
    "sasl_mechanism": null,
    "sasl_plain_username": null,
    "sasl_plain_password": null
  },
  "producer": {
    "acks": "all",
    "retries": 3,
    "batch_size": 16384,
    "linger_ms": 10,
    "buffer_memory": 33554432,
    "compression_type": "lz4",
    "max_request_size": 1048576,
    "max_in_flight_requests_per_connection": 5,
    "idempotence": true
  },
  "consumer": {
    "auto_offset_reset": "earliest",
    "enable_auto_commit": false,
    "auto_commit_interval_ms": 5000,
    "session_timeout_ms": 30000,
    "heartbeat_interval_ms": 10000,
    "max_poll_records": 500,
    "fetch_min_bytes": 1,
    "fetch_max_wait_ms": 500,
    "isolation_level": "read_committed"
  },
  "topics": {
    "user_domain": {
      "description": "User-specific events (isolated, persistent)",
      "auth": {
        "name": "user.auth",
        "partitions": 3,
        "replication_factor": 1,
        "retention_ms": 7776000000,
        "cleanup_policy": "delete",
        "description": "User authentication events (login, logout, session)"
      },
      "settings": {
        "name": "user.settings",
        "partitions": 3,
        "replication_factor": 1,
        "retention_ms": -1,
        "cleanup_policy": "compact",
        "description": "User account settings (event sourcing, infinite retention)"
      },
      "commands": {
        "name": "user.commands",
        "partitions": 6,
        "replication_factor": 1,
        "retention_ms": 220903200000,
        "cleanup_policy": "delete",
        "description": "Trading commands (buy, sell, close) - 7 years compliance"
      },
      "trades": {
        "name": "user.trades",
        "partitions": 6,
        "replication_factor": 1,
        "retention_ms": 220903200000,
        "cleanup_policy": "delete",
        "min_compaction_lag_ms": 86400000,
        "description": "Trade executions - 7 years compliance (FINRA, MiFID II)"
      },
      "mt5_status": {
        "name": "user.mt5_status",
        "partitions": 3,
        "replication_factor": 1,
        "retention_ms": 2592000000,
        "cleanup_policy": "delete",
        "description": "MT5 account status (balance, equity, margin) - 30 days"
      },
      "risk_alerts": {
        "name": "user.risk_alerts",
        "partitions": 3,
        "replication_factor": 1,
        "retention_ms": 31536000000,
        "cleanup_policy": "delete",
        "description": "Risk management alerts (stop-out, margin call) - 1 year"
      },
      "transactions": {
        "name": "user.transactions",
        "partitions": 3,
        "replication_factor": 1,
        "retention_ms": 315360000000,
        "cleanup_policy": "delete",
        "description": "Financial transactions (deposits, withdrawals) - 10 years"
      },
      "backtests": {
        "name": "user.backtests",
        "partitions": 3,
        "replication_factor": 1,
        "retention_ms": 7776000000,
        "cleanup_policy": "delete",
        "description": "User backtest results - 90 days"
      }
    },
    "system_domain": {
      "description": "System events (monitoring, audit)",
      "events": {
        "name": "system.events",
        "partitions": 3,
        "replication_factor": 1,
        "retention_ms": 2592000000,
        "cleanup_policy": "delete",
        "description": "System-wide events - 30 days"
      },
      "metrics": {
        "name": "system.metrics",
        "partitions": 3,
        "replication_factor": 1,
        "retention_ms": 604800000,
        "cleanup_policy": "delete",
        "description": "System metrics - 7 days"
      },
      "audit": {
        "name": "system.audit",
        "partitions": 3,
        "replication_factor": 1,
        "retention_ms": 220903200000,
        "cleanup_policy": "delete",
        "description": "System audit trail - 7 years compliance"
      }
    }
  },
  "consumer_groups": {
    "description": "Pre-defined consumer groups for services",
    "trading_engine": {
      "group_id": "trading-engine",
      "topics": ["user.commands"],
      "auto_offset_reset": "earliest",
      "enable_auto_commit": false
    },
    "audit_service": {
      "group_id": "audit-service",
      "topics": ["user.trades", "user.transactions", "system.audit"],
      "auto_offset_reset": "earliest",
      "enable_auto_commit": true
    },
    "notification_service": {
      "group_id": "notification-service",
      "topics": ["user.trades", "user.risk_alerts"],
      "auto_offset_reset": "latest",
      "enable_auto_commit": true
    },
    "analytics_service": {
      "group_id": "analytics-service",
      "topics": ["user.trades", "system.metrics"],
      "auto_offset_reset": "earliest",
      "enable_auto_commit": false
    },
    "websocket_per_user": {
      "group_id": "websocket_{user_id}",
      "topics": ["user.trades", "user.mt5_status", "user.risk_alerts"],
      "auto_offset_reset": "latest",
      "enable_auto_commit": true,
      "description": "Each user WebSocket gets own consumer group"
    }
  },
  "partitioning_strategy": {
    "description": "Partition by user_id for isolation and ordering",
    "key_serializer": "string",
    "partitioner_class": "DefaultPartitioner",
    "example": "hash(user_id) % num_partitions",
    "benefits": [
      "All events for same user â†’ same partition (ordering)",
      "Users evenly distributed (load balancing)",
      "Parallel processing (1 consumer per partition)",
      "Data isolation (user data never mixed)"
    ]
  },
  "admin": {
    "request_timeout_ms": 30000,
    "connections_max_idle_ms": 540000,
    "metadata_max_age_ms": 300000
  },
  "security": {
    "description": "Security configuration",
    "ssl_enabled": false,
    "sasl_enabled": false,
    "acl_enabled": false,
    "encryption_at_rest": false,
    "encryption_in_transit": false,
    "note": "Enable SSL/SASL in production"
  },
  "compliance": {
    "description": "Regulatory compliance requirements",
    "regulations": {
      "FINRA_4511": {
        "requirement": "Preserve all trade communications",
        "retention": "7 years (220903200000 ms)",
        "topics": ["user.commands", "user.trades"]
      },
      "MiFID_II": {
        "requirement": "Trade reporting and audit trail",
        "retention": "7 years",
        "topics": ["user.trades", "system.audit"]
      },
      "GDPR": {
        "requirement": "Right to be forgotten (user data deletion)",
        "implementation": "Delete user partition or topic",
        "topics": ["user.*"]
      },
      "SOX": {
        "requirement": "Financial transaction audit",
        "retention": "10 years (315360000000 ms)",
        "topics": ["user.transactions"]
      }
    }
  }
}
